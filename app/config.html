<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>NecroBot Visualizer - Config</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="assets/css/app.css">
    <link rel="stylesheet" href="assets/css/config.css">

    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <script>if (window.module) module = window.module;</script>

    <script>
        const { remote } = require("electron");
        const dialog = remote.dialog;
        const config = require("./scripts/config");
        var appconfig = config.load();

        function chooseDir() {
            dialog.showOpenDialog({properties: ['openDirectory']}, (dir) => {
                if (dir != undefined) {
                   var folder = dir[0]; 
                   $("#txtFolder").val(folder);
                };
            });
        }

        function saveConfig() {
            appconfig.locale = $("#slLocale").val();
            appconfig.necrofolder = $("#txtFolder").val();
            console.log(appconfig);
            config.save(appconfig);
            navigateAway();
        }

        function navigateAway() {
            window.location = "index.html";
        }

        $(function() {
            $("#slLocale").val(appconfig.locale);
            $("#txtFolder").val(appconfig.necrofolder);

            $("#chooseBtn").click(chooseDir);
            $("#saveBtn").click(saveConfig);
            $("#cancelBtn").click(navigateAway);
        });
    </script>    
  </head>
  
  <body>
    <div class="content">
        <h2>Config</h2>
        <form>
            <ul class="config-form">
                <li>
                    <label>Locale</label>
                    <select id="slLocale" name="locale" class="field-select">
                        <option value="en">English</option>
                        <option value="fr">Francais</option>
                    </select>
                </li>
                <li>
                    <label>Necrobot Folder</label>
                    <input type="text" id="txtFolder" class="field-folder" placeholder="NecroBot folder" />
                    <input type="button" id="chooseBtn" value="Choose Folder"></input>
                </li>
                <li>
                    <input id="saveBtn" type="button" value="Save" />
                    <input id="cancelBtn" type="button" value="Cancel" />
                </li>
            </ul>
        </form>
    </div>
  </body>

</html>